# Forudsigelse af YoYK3
newdata_q3_2025 <- data.frame(DI_FTI = -16.5)
# Beregn sandsynligheden for "op"
predict(mod_DI_log, newdata = newdata_q3_2025, type = "response")

# ROC-analyse
roc_DI <- roc(ny_data$Direction, p_DI, levels = c("0","1"))
roc_DST <- roc(ny_data$Direction, p_DST, levels = c("0","1"))

# Plot ROC-kurven DI
plot(roc_DI, col = "blue", lwd = 2, main = "ROC-kurve for DI-logistisk model")
abline(a = 0, b = 1, lty = 2, col = "gray")  # diagonal som reference

# Plot ROC-kurven DST
plot(roc_DI, col = "red", lwd = 2, main = "ROC-kurve for DI-logistisk model")
abline(a = 0, b = 1, lty = 2, col = "gray")  # diagonal som reference



plot(roc_DI, col = "blue", lwd = 2, main = "ROC-kurver for DI og DST modeller")
plot(roc_DST, col = "red", lwd = 2, add = TRUE)
abline(a = 0, b = 1, lty = 2, col = "gray")

legend("bottomright",
       legend = c(
         paste0("DI-model (AUC = ", round(auc(roc_DI), 3), ")"),
         paste0("DST-model (AUC = ", round(auc(roc_DST), 3), ")")
       ),
       col = c("blue", "red"),
       lwd = 2)

save.image("mitprojekt_predict.Rdata")

coords(roc_DI, "best", ret = c("threshold", "sensitivity", "specificity"))
coords(roc_DST, "best", ret = c("threshold", "sensitivity", "specificity"))
